<div class="container px-5 px-sm-0">
  <div class="row">
    <!--部分テンプレート-->
    <%= render 'books/new_form', user: @user, book: @book %>
    <!--投稿詳細のコード-->
     <div class="col-md-8 offset-md-1">
       <h2>投稿詳細</h2>
       <table class="table">
         <tbody>
           <tr>
             <td>
               <%= link_to user_path(@books.user.id) do %>
               <%= attachment_image_tag @books.user, :profile_image, :fill, 40, 40, format: 'jpeg', fallback: "no_image.jpg", size:'40x40', class: "m-2 attachment user profile_image" %>
               <% end %>
             </td>
             <td><%= link_to @books.title,book_path(@books) %></td>
             <td class="text-white"><%= @books.body %></td>
             <!--ログインしているユーザーのshowページだった場合表示される-->
             <% if @user.id == current_user.id %>
             <td><%= link_to "編集",edit_book_path(@books) %></td>
             <td><%= link_to "削除",book_path(@books), method: :delete %></td>
             <% end %>
           </tr>
         </tbody>
       </table>
       <!--コメント作成機能-->
       <div class="comments">
         <h2 class="mt-3">新規投稿</h2>
      <!--コメント投稿フォームの作成-->
         <%= form_with(model:[@books, @book_comment],local: true) do |f| %>
       <div class="form-group">
         <%= f.text_area :comment, rows:'2',placeholder: "コメント" %>
       </div>
       <div class="form-group">
         <%= f.submit '投稿', class: "btn btn-success" %>
       </div>
       <% end %>
         <!--もし、コメントが無ければ、コメント無しとビューで表記し、あれば何個コメントがあるか表記するコード-->
         <% if @books.book_comments.count == 0 then %>
         <p>コメント無し</p>
         <% else %>
         <p>コメント件数:<%= @books.book_comments.count %></p>
         <table class="table">
           <thead>
             <tr>
               <th></th>
               <th>コメント</th>
               <th colspan="2"></th>
             </tr>
           </thead>
           <tbody>
             <% @books.book_comments.each do |book_comments| %>
               <tr>
                 <td>
                   <%= attachment_image_tag book_comments.user, :profile_image, :fill, 40, 40, format: 'jpeg', fallback: "no_image.jpg", size:'40x40', class: "m-2 attachment user profile_image" %>
                   <br><%= book_comments.user.name %>
                 </td>
                 <td><%= book_comments.comments %></td>
                 <!--コメントの、投稿日時を呼び出すコード-->
                 <td><%= book_comments.created_at.strftime('%Y-%m-%d H:%M') %></td>
                 <td></td>
               </tr>
             <% end %>
           </tbody>
          <% end %>
          </table>
        </div>
     </div>
  </div>
</div>